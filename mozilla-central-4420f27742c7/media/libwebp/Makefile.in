# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.


DEPTH = @DEPTH@
topsrcdir = @top_srcdir@
srcdir = @srcdir@
VPATH = @srcdir@

include $(DEPTH)/config/autoconf.mk

LIBRARY_NAME = mozwebp
FORCE_STATIC_LIB = 1
ifeq (WINT,$(OS_ARCH))
VISIBILITY_FLAGS=
endif

LOCAL_INCLUDES += \
  -I. \
  -I$(topsrcdir)/media/libwebp \
  -I$(topsrcdir)/media/libwebp/src/ \
  -I$(topsrcdir)/media/libwebp/src/dec/ \
  -I$(topsrcdir)/media/libwebp/src/dsp/ \
  -I$(topsrcdir)/media/libwebp/src/enc/ \
  -I$(topsrcdir)/media/libwebp/src/utils/ \
  -I$(topsrcdir)/media/libwebp/src/webp/ \
  $(NULL)

VPATH += \
  $(srcdir)/src/dec/ \
  $(srcdir)/src/dsp/ \
  $(srcdir)/src/utils/ \
  $(NULL)

EXPORTS_NAMESPACES = webp

EXPORTS_webp = \
  src/webp/types.h \
  src/webp/decode.h \
  $(NULL)

CSRCS += \
  alpha.c \
  bit_reader.c \
  bit_writer.c \
  buffer.c \
  color_cache.c \
  cpu.c \
  dec.c \
  dec_neon.c \
  dec_sse2.c \
  enc.c \
  enc_sse2.c \
  filters.c \
  frame.c \
  huffman.c \
  huffman_encode.c \
  idec.c \
  io.c \
  layer.c \
  lossless.c \
  quant.c \
  quant_levels.c \
  rescaler.c \
  thread.c \
  tree.c \
  upsampling.c \
  upsampling_sse2.c \
  utils.c \
  vp8.c \
  vp8l.c \
  webp.c \
  yuv.c \
  $(NULL)

ifdef MOZ_WEBP_ENCODER
VPATH += \
  $(srcdir)/src/enc/ \
  $(NULL)

EXPORTS_webp += \
  src/webp/encode.h \
  $(NULL)

CSRCS += \
  alpha.c \
  analysis.c \
  backward_references.c \
  config.c \
  cost.c \
  filter.c \
  frame.c \
  histogram.c \
  iterator.c \
  layer.c \
  picture.c \
  quant.c \
  syntax.c \
  tree.c \
  vp8l.c \
  webpenc.c \
  $(NULL)
endif

